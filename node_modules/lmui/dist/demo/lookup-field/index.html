<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <title>UI components - lookup field</title>
    <script src="../lib/vue.js"></script>
    <script src="../lib/jquery.js"></script>
    <script src="../../build/LookupField.js"></script>
    <script src="../../../src/svgicons.js"></script>
    <link type="text/css" rel="stylesheet" href="../../build/css/LookupField.css">
</head>
<body>
<div id="app">
    <h1>lookupfiled</h1>
    <p>isGlob = false</p>
    <button class="update-value" >Set to first item</button>
    <my-lookup @lookup="onLookup" :items="list" width="400" :is-glob="false" @validate="doValidate" :initial-selected-item="selectedItem" ref="lookup"></my-lookup>

    <p>isGlob = true, isAllowManuallyChangeGlob = false</p>

    <my-lookup @lookup="onLookup" :items="list" width="400" :is-glob="true" @validate="doValidate"  style="margin-bottom: 40px;" :is-allow-manually-change-glob="false"
               :initial-selected-item="selectedItem" ref="lookup2"></my-lookup>

    <p>isGlob = true, isAllowManuallyChangeGlob = true, isGlobToggleActive = true</p>
    <my-lookup @lookup="onLookup" :items="list" width="400" :is-glob="true" @validate="doValidate" style="margin-bottom: 40px;"
               :is-allow-manually-change-glob="true"  :is-initial-glob-toggle-active="true"
               :initial-selected-item="selectedItem" ref="lookup3"></my-lookup>

    <p>isGlob = true, isAllowManuallyChangeGlob = true, isGlobToggleActive = false</p>
    <my-lookup @lookup="onLookup" @globchanged="onGlobToggleChanged" @validate="doValidate"
               :items="list" width="400" :is-glob="true" style="margin-bottom: 40px;"
               :is-allow-manually-change-glob="true" :is-initial-glob-toggle-active="false"
               :initial-selected-item="selectedItem" ref="lookup3"></my-lookup>
    <p>Glob Enable Status: {{globEnableStatus}}</p>
</div>
<script>
    var fullData = [
        { abbr: "AL", name: "Alabamalonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglonglong"},
        { abbr: "AK", name: "Alaska Alaska Alaska Alaska Alaska Alaska Alaska Alaska Alaska Alaska Alaska Alaska"},
        { abbr: "C:\\", name: "C:\\"},
        { abbr: "AR", name: "Arkansas"},
        { abbr: "CA", name: "California"},
        { abbr: "CO", name: "Colorado"},
        { abbr: "CT", name: "Connecticut"},
        { abbr: "DE", name: "Delaware"},
        { abbr: "FL", name: "Florida"},
        { abbr: "GA", name: "Georgia"},
        { abbr: "HI", name: "Hawaii"},
        { abbr: "ID", name: "Idaho"},
        { abbr: "IL", name: "Illinois"},
        { abbr: "IN", name: "Indiana"},
        { abbr: "IA", name: "Iowa"},
        { abbr: "KS", name: "Kansas"},
        { abbr: "KY", name: "Kentucky"},
        { abbr: "LA", name: "Louisiana"},
        { abbr: "ME", name: "Maine"},
        { abbr: "MD", name: "Maryland"},
        { abbr: "MA", name: "Massachusetts"},
        { abbr: "MI", name: "Michigan"},
        { abbr: "MN", name: "Minnesota"},
        { abbr: "MS", name: "Mississippi"},
        { abbr: "MO", name: "Missouri"},
        { abbr: "MT", name: "Montana"},
        { abbr: "NE", name: "Nebraska"},
        { abbr: "NV", name: "Nevada"},
        { abbr: "NH", name: "New Hampshire"},
        { abbr: "NJ", name: "New Jersey"},
        { abbr: "NM", name: "New Mexico"},
        { abbr: "NY", name: "New York"},
        { abbr: "NC", name: "North Carolina"},
        { abbr: "ND", name: "North Dakota"},
        { abbr: "OH", name: "Ohio"},
        { abbr: "OK", name: "Oklahoma"},
        { abbr: "OR", name: "Oregon"},
        { abbr: "PA", name: "Pennsylvania"},
        { abbr: "RI", name: "Rhode Island"},
        { abbr: "SC", name: "South Carolina"},
        { abbr: "SD", name: "South Dakota"},
        { abbr: "TN", name: "Tennessee"},
        { abbr: "TX", name: "Texas"},
        { abbr: "UT", name: "Utah"},
        { abbr: "VT", name: "Vermont"},
        { abbr: "VA", name: "Virginia"},
        { abbr: "WA", name: "Washington"},
        { abbr: "WV", name: "West Virginia"},
        { abbr: "WI", name: "Wisconsin"},
        { abbr: "WY", name: "Wyoming"}
    ];
    var LookupField = LMUI.LookupField;

    var vue = new Vue({
        el: '#app',
        data: function () {
            return {
                list: [],
                selectedItem: {
                    id: 'haha',
                    name: 'aaa'
                },
                globEnableStatus: false
            }
        },
        components: {
            'myLookup': LookupField
        },
        methods: {
            onLookup: function (query) {
                var result = [];
                var me = this;
                setTimeout(function () {
                    fullData.forEach(function (datum) {
                        if (~datum.name.toLowerCase().indexOf(query.toLowerCase())) {
                            result.push(datum.name);
                        }
                    });
                    me.list = result;
                }, 1000);
            },

            doValidate: function (query) {
                console.log('validate');
                if (!this.$refs.lookup.validateSelectedItem(true)) {
                    console.log('this field is required, and you must select result from the dropdown');
                }
            },

            onGlobToggleChanged: function(isGlobEnabled) {
                this.globEnableStatus = isGlobEnabled;
            }
        }
    });


    $('.update-value').on('click', function () {
        vue.$refs.lookup.updateSelectItem(fullData[0]);
    });
</script>
</body>
</html>
